"use strict";function _interopDefault(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var window$1=_interopDefault(require("window")),indiv=_interopDefault(require("indiv")),_defined=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t},_toObject=function(t){return Object(_defined(t))},hasOwnProperty={}.hasOwnProperty,_has=function(t,e){return hasOwnProperty.call(t,e)},toString={}.toString,_cof=function(t){return toString.call(t).slice(8,-1)},_iobject=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==_cof(t)?t.split(""):Object(t)},_toIobject=function(t){return _iobject(_defined(t))},ceil=Math.ceil,floor=Math.floor,_toInteger=function(t){return isNaN(t=+t)?0:(t>0?floor:ceil)(t)},min=Math.min,_toLength=function(t){return t>0?min(_toInteger(t),9007199254740991):0},max=Math.max,min$1=Math.min,_toAbsoluteIndex=function(t,e){return(t=_toInteger(t))<0?max(t+e,0):min$1(t,e)},_arrayIncludes=function(t){return function(e,r,n){var o,i=_toIobject(e),c=_toLength(i.length),u=_toAbsoluteIndex(n,c);if(t&&r!=r){for(;c>u;)if((o=i[u++])!=o)return!0}else for(;c>u;u++)if((t||u in i)&&i[u]===r)return t||u||0;return!t&&-1}};function createCommonjsModule(t,e){return t(e={exports:{}},e.exports),e.exports}var _core=createCommonjsModule(function(t){var e=t.exports={version:"2.5.7"};"number"==typeof __e&&(__e=e)}),_core_1=_core.version,_global=createCommonjsModule(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)}),_library=!0,_shared=createCommonjsModule(function(t){var e=_global["__core-js_shared__"]||(_global["__core-js_shared__"]={});(t.exports=function(t,r){return e[t]||(e[t]=void 0!==r?r:{})})("versions",[]).push({version:_core.version,mode:"pure",copyright:"Â© 2018 Denis Pushkarev (zloirock.ru)"})}),id=0,px=Math.random(),_uid=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++id+px).toString(36))},shared=_shared("keys"),_sharedKey=function(t){return shared[t]||(shared[t]=_uid(t))},arrayIndexOf=_arrayIncludes(!1),IE_PROTO=_sharedKey("IE_PROTO"),_objectKeysInternal=function(t,e){var r,n=_toIobject(t),o=0,i=[];for(r in n)r!=IE_PROTO&&_has(n,r)&&i.push(r);for(;e.length>o;)_has(n,r=e[o++])&&(~arrayIndexOf(i,r)||i.push(r));return i},_enumBugKeys="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),_objectKeys=Object.keys||function(t){return _objectKeysInternal(t,_enumBugKeys)},_aFunction=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t},_ctx=function(t,e,r){if(_aFunction(t),void 0===e)return t;switch(r){case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,o){return t.call(e,r,n,o)}}return function(){return t.apply(e,arguments)}},_isObject=function(t){return"object"==typeof t?null!==t:"function"==typeof t},_anObject=function(t){if(!_isObject(t))throw TypeError(t+" is not an object!");return t},_fails=function(t){try{return!!t()}catch(t){return!0}},_descriptors=!_fails(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),document=_global.document,is=_isObject(document)&&_isObject(document.createElement),_domCreate=function(t){return is?document.createElement(t):{}},_ie8DomDefine=!_descriptors&&!_fails(function(){return 7!=Object.defineProperty(_domCreate("div"),"a",{get:function(){return 7}}).a}),_toPrimitive=function(t,e){if(!_isObject(t))return t;var r,n;if(e&&"function"==typeof(r=t.toString)&&!_isObject(n=r.call(t)))return n;if("function"==typeof(r=t.valueOf)&&!_isObject(n=r.call(t)))return n;if(!e&&"function"==typeof(r=t.toString)&&!_isObject(n=r.call(t)))return n;throw TypeError("Can't convert object to primitive value")},dP=Object.defineProperty,f=_descriptors?Object.defineProperty:function(t,e,r){if(_anObject(t),e=_toPrimitive(e,!0),_anObject(r),_ie8DomDefine)try{return dP(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[e]=r.value),t},_objectDp={f:f},_propertyDesc=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},_hide=_descriptors?function(t,e,r){return _objectDp.f(t,e,_propertyDesc(1,r))}:function(t,e,r){return t[e]=r,t},PROTOTYPE="prototype",$export=function(t,e,r){var n,o,i,c=t&$export.F,u=t&$export.G,a=t&$export.S,s=t&$export.P,l=t&$export.B,p=t&$export.W,f=u?_core:_core[e]||(_core[e]={}),d=f[PROTOTYPE],_=u?_global:a?_global[e]:(_global[e]||{})[PROTOTYPE];for(n in u&&(r=e),r)(o=!c&&_&&void 0!==_[n])&&_has(f,n)||(i=o?_[n]:r[n],f[n]=u&&"function"!=typeof _[n]?r[n]:l&&o?_ctx(i,_global):p&&_[n]==i?function(t){var e=function(e,r,n){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,r)}return new t(e,r,n)}return t.apply(this,arguments)};return e[PROTOTYPE]=t[PROTOTYPE],e}(i):s&&"function"==typeof i?_ctx(Function.call,i):i,s&&((f.virtual||(f.virtual={}))[n]=i,t&$export.R&&d&&!d[n]&&_hide(d,n,i)))};$export.F=1,$export.G=2,$export.S=4,$export.P=8,$export.B=16,$export.W=32,$export.U=64,$export.R=128;var _export=$export,_objectSap=function(t,e){var r=(_core.Object||{})[t]||Object[t],n={};n[t]=e(r),_export(_export.S+_export.F*_fails(function(){r(1)}),"Object",n)};_objectSap("keys",function(){return function(t){return _objectKeys(_toObject(t))}});var keys=_core.Object.keys,keys$1=keys,_stringAt=function(t){return function(e,r){var n,o,i=String(_defined(e)),c=_toInteger(r),u=i.length;return c<0||c>=u?t?"":void 0:(n=i.charCodeAt(c))<55296||n>56319||c+1===u||(o=i.charCodeAt(c+1))<56320||o>57343?t?i.charAt(c):n:t?i.slice(c,c+2):o-56320+(n-55296<<10)+65536}},_redefine=_hide,_iterators={},_objectDps=_descriptors?Object.defineProperties:function(t,e){_anObject(t);for(var r,n=_objectKeys(e),o=n.length,i=0;o>i;)_objectDp.f(t,r=n[i++],e[r]);return t},document$1=_global.document,_html=document$1&&document$1.documentElement,IE_PROTO$1=_sharedKey("IE_PROTO"),Empty=function(){},PROTOTYPE$1="prototype",createDict=function(){var t,e=_domCreate("iframe"),r=_enumBugKeys.length;for(e.style.display="none",_html.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),createDict=t.F;r--;)delete createDict[PROTOTYPE$1][_enumBugKeys[r]];return createDict()},_objectCreate=Object.create||function(t,e){var r;return null!==t?(Empty[PROTOTYPE$1]=_anObject(t),r=new Empty,Empty[PROTOTYPE$1]=null,r[IE_PROTO$1]=t):r=createDict(),void 0===e?r:_objectDps(r,e)},_wks=createCommonjsModule(function(t){var e=_shared("wks"),r=_global.Symbol,n="function"==typeof r;(t.exports=function(t){return e[t]||(e[t]=n&&r[t]||(n?r:_uid)("Symbol."+t))}).store=e}),def=_objectDp.f,TAG=_wks("toStringTag"),_setToStringTag=function(t,e,r){t&&!_has(t=r?t:t.prototype,TAG)&&def(t,TAG,{configurable:!0,value:e})},IteratorPrototype={};_hide(IteratorPrototype,_wks("iterator"),function(){return this});var _iterCreate=function(t,e,r){t.prototype=_objectCreate(IteratorPrototype,{next:_propertyDesc(1,r)}),_setToStringTag(t,e+" Iterator")},IE_PROTO$2=_sharedKey("IE_PROTO"),ObjectProto=Object.prototype,_objectGpo=Object.getPrototypeOf||function(t){return t=_toObject(t),_has(t,IE_PROTO$2)?t[IE_PROTO$2]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?ObjectProto:null},ITERATOR=_wks("iterator"),BUGGY=!([].keys&&"next"in[].keys()),FF_ITERATOR="@@iterator",KEYS="keys",VALUES="values",returnThis=function(){return this},_iterDefine=function(t,e,r,n,o,i,c){_iterCreate(r,e,n);var u,a,s,l=function(t){if(!BUGGY&&t in _)return _[t];switch(t){case KEYS:case VALUES:return function(){return new r(this,t)}}return function(){return new r(this,t)}},p=e+" Iterator",f=o==VALUES,d=!1,_=t.prototype,m=_[ITERATOR]||_[FF_ITERATOR]||o&&_[o],h=m||l(o),y=o?f?l("entries"):h:void 0,$="Array"==e&&_.entries||m;if($&&(s=_objectGpo($.call(new t)))!==Object.prototype&&s.next&&(_setToStringTag(s,p,!0),_library||"function"==typeof s[ITERATOR]||_hide(s,ITERATOR,returnThis)),f&&m&&m.name!==VALUES&&(d=!0,h=function(){return m.call(this)}),_library&&!c||!BUGGY&&!d&&_[ITERATOR]||_hide(_,ITERATOR,h),_iterators[e]=h,_iterators[p]=returnThis,o)if(u={values:f?h:l(VALUES),keys:i?h:l(KEYS),entries:y},c)for(a in u)a in _||_redefine(_,a,u[a]);else _export(_export.P+_export.F*(BUGGY||d),e,u);return u},$at=_stringAt(!0);_iterDefine(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,r=this._i;return r>=e.length?{value:void 0,done:!0}:(t=$at(e,r),this._i+=t.length,{value:t,done:!1})});var _iterCall=function(t,e,r,n){try{return n?e(_anObject(r)[0],r[1]):e(r)}catch(e){var o=t.return;throw void 0!==o&&_anObject(o.call(t)),e}},ITERATOR$1=_wks("iterator"),ArrayProto=Array.prototype,_isArrayIter=function(t){return void 0!==t&&(_iterators.Array===t||ArrayProto[ITERATOR$1]===t)},_createProperty=function(t,e,r){e in t?_objectDp.f(t,e,_propertyDesc(0,r)):t[e]=r},TAG$1=_wks("toStringTag"),ARG="Arguments"==_cof(function(){return arguments}()),tryGet=function(t,e){try{return t[e]}catch(t){}},_classof=function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=tryGet(e=Object(t),TAG$1))?r:ARG?_cof(e):"Object"==(n=_cof(e))&&"function"==typeof e.callee?"Arguments":n},ITERATOR$2=_wks("iterator"),core_getIteratorMethod=_core.getIteratorMethod=function(t){if(null!=t)return t[ITERATOR$2]||t["@@iterator"]||_iterators[_classof(t)]},ITERATOR$3=_wks("iterator"),SAFE_CLOSING=!1;try{var riter=[7][ITERATOR$3]();riter.return=function(){SAFE_CLOSING=!0}}catch(t){}var _iterDetect=function(t,e){if(!e&&!SAFE_CLOSING)return!1;var r=!1;try{var n=[7],o=n[ITERATOR$3]();o.next=function(){return{done:r=!0}},n[ITERATOR$3]=function(){return o},t(n)}catch(t){}return r};_export(_export.S+_export.F*!_iterDetect(function(t){}),"Array",{from:function(t){var e,r,n,o,i=_toObject(t),c="function"==typeof this?this:Array,u=arguments.length,a=u>1?arguments[1]:void 0,s=void 0!==a,l=0,p=core_getIteratorMethod(i);if(s&&(a=_ctx(a,u>2?arguments[2]:void 0,2)),null==p||c==Array&&_isArrayIter(p))for(r=new c(e=_toLength(i.length));e>l;l++)_createProperty(r,l,s?a(i[l],l):i[l]);else for(o=p.call(i),r=new c;!(n=o.next()).done;l++)_createProperty(r,l,s?_iterCall(o,a,[n.value,l],!0):n.value);return r.length=l,r}});var from_1=_core.Array.from,from_1$1=from_1;function formatInnerHTML(t){return t=(t=t.replace(/(\n\s*)/g,"")).replace(/^[^\S\n]+/gm,"")}var utils=formatInnerHTML;const CompileUtil=indiv.CompileUtil,window$2=new window$1,document$2=window$2.document;class Compile{constructor(t,e){this.$vm=e,this.$fragment=this.node2Fragment(),this.init(),this.$el=t,this.$el&&from_1$1(this.$fragment.childNodes).forEach(t=>{this.$el.appendChild(t)})}init(){this.compileElement(this.$fragment)}compileElement(t){const e=document$2.createElement("div");e.innerHTML=utils(this.$vm.$template);const r=e.childNodes;this.recursiveDOM(r,t)}recursiveDOM(t,e){from_1$1(t).forEach(t=>{t.hasChildNodes()&&!this.isRepeatNode(t)&&this.recursiveDOM(t.childNodes,t),e.appendChild(t);const r=t.textContent;if(this.isElementNode(t)&&this.compile(t,e),this.isTextNode(t)&&/\{\{(.*)\}\}/g.test(r)){const e=r.match(/(\{\{[^\{\}]+?\}\})/g);if(e&&e.length>0)for(let r=0;r<e.length;r++)this.compileText(t,e[r])}this.isRepeatNode(t)&&e.contains(t)&&e.removeChild(t)})}compile(t,e){const r=t.attributes;r&&from_1$1(r).forEach(r=>{const n=r.name;if(this.isDirective(n)){const o=n.substring(3),i=r.value;this.isEventDirective(o)||new CompileUtil(e).bind(t,this.$vm,i,o)}})}node2Fragment(){return document$2.createDocumentFragment()}compileText(t,e){new CompileUtil(this.$fragment).templateUpdater(t,this.$vm,e)}isDirective(t){return 0===t.indexOf("nv-")}isEventDirective(t){return 0===t.indexOf("on")}isElementNode(t){return"string"!=typeof t&&1===t.nodeType}isRepeatNode(t){const e=t.attributes;let r=!1;return e&&from_1$1(e).forEach(t=>{"nv-repeat"===t.name&&(r=!0)}),r}isTextNode(t){return 3===t.nodeType}}var compile=Compile;const Utils=indiv.Utils,factoryCreator=indiv.factoryCreator,utils$1=new Utils;function getPropsValue(t,e){let r=e;return t.forEach((t,e)=>{0!==e&&(r=r[t])}),r}function buildProps(t,e){return utils$1.isFunction(t)?t.bind(e):t}function buildComponentScope(t,e,r,n,o){const i=factoryCreator(t,o);return i.props=e,i.renderDom=r,i.$components=n.$components,i}var renderUtils={getPropsValue:getPropsValue,buildProps:buildProps,buildComponentScope:buildComponentScope};const buildProps$1=renderUtils.buildProps,getPropsValue$1=renderUtils.getPropsValue,buildComponentScope$1=renderUtils.buildComponentScope,factoryCreator$1=indiv.factoryCreator,CompileUtilForRepeat=indiv.CompileUtilForRepeat;function instantiateComponent(t,e,r,n){const o=factoryCreator$1(t,e);return o.$components=e.$components,o.nvOnInit&&o.nvOnInit(),o.$template&&"string"==typeof o.$template&&r?(replaceDom(o,e,r,n),o):(console.error("renderBootstrap failed: template or rootDom is not exit"),!1)}function replaceDom(t,e,r,n){t.renderDom=r,new compile(r,t),mountComponent(t,e,r,n),t.$componentList.forEach(t=>{replaceDom(t.scope,e,t.dom,n)})}function mountComponent(t,e,r,n){componentsConstructor(t,e,r,n),t.$componentList.forEach(e=>{e.scope.$components=t.$components,e.scope.nvOnInit&&e.scope.nvOnInit()})}function componentsConstructor(t,e,r,n){t.$componentList=[];const o=r.querySelectorAll(n)[0];t.constructor._injectedComponents.forEach((e,r)=>{t.$components.find(t=>t.$selector===r)||t.$components.push(e)});for(let n=0;n<=t.$components.length-1;n++){const i=t.$components[n].$selector,c=r.getElementsByTagName(i);from_1$1(c).forEach(r=>{if(o&&o.contains(r))return;const i=r.attributes,c={};if(i){const e=from_1$1(i),n={};e.forEach(t=>{/^\_prop\-(.+)/.test(t.name)&&(n[t.name.replace("_prop-","")]=JSON.parse(t.value),r.removeAttribute(t.name))}),e.forEach(e=>{const o=e.name;if(/^\_prop\-(.+)/.test(e.name))return;const i=o.split("-");i.length>1&&i.forEach((t,e)=>{0===e&&(o=t),0!==e&&(o+=t.toLowerCase().replace(/( |^)[a-z]/g,t=>t.toUpperCase()))});const u=/^\{(.+)\}$/.exec(e.value);if(u){const e=u[1].split("."),i=e[0];let a=null;if(/^(state.).*/g.test(u[1]))return a=t.compileUtil._getVMVal(t,u[1]),void(c[o]=buildProps$1(a,t));if(/^(\@.).*\(.*\)$/g.test(u[1])){const e=new CompileUtilForRepeat,n=e._getVMFunction(t,u[1]),i=u[1].replace(/^(\@)/,"").match(/\((.*)\)/)[1].replace(/\s+/g,"").split(","),a=[];i.forEach(n=>""!==n&&("$element"===n?a.push(r):"true"===n||"false"===n?a.push("true"===n):/(state.).*/g.test(n)?a.push(e._getVMVal(t,n)):/\'.*\'/g.test(n)?a.push(n.match(/\'(.*)\'/)[1]):!/\'.*\'/g.test(n)&&/^[0-9]*$/g.test(n)?a.push(Number(n)):void(r.repeatData&&keys$1(r.repeatData).forEach(t=>{if(0===n.indexOf(t)||0===n.indexOf(`${t}.`))return a.push(e._getValueByValue(r.repeatData[t],n,t))}))));const s=n.apply(t,a);return void(c[o]=s)}if(/^(\@.).*[^\(.*\)]$/g.test(u[1]))return a=t.compileUtil._getVMVal(t,u[1].replace(/^(\@)/,"")),void(c[o]=buildProps$1(a,t));if(n.hasOwnProperty(i))return a=getPropsValue$1(e,n[i]),void(c[o]=buildProps$1(a,t));if(r.repeatData&&null!==r.repeatData[i])return a=t.compileUtil._getValueByValue(r.repeatData[i],u[1],i),void(c[o]=buildProps$1(a,t))}"indiv_repeat_key"!==e.name&&r.removeAttribute(o)})}t.$componentList.push({dom:r,props:c,scope:buildComponentScope$1(t.$components[n],c,r,t,e)})})}}var component=instantiateComponent;const window$3=new window$1,document$3=window$3.document,domToString=(()=>{const t=document$3.createElement("div");return"outerHTML"in t?t=>t.outerHTML:e=>{const r=t.cloneNode();return r.appendChild(e.cloneNode(!0)),r.innerHTML}})();var toString_1=domToString;function buildPath(t){const e="/"===t?["/"]:t.split("/");return e[0]="/",e}function findRoutes(t,e,r){let n=[];for(let o=0;o<t.length;o++){const i=t[o];if(0===o){const c=e.find(t=>t.path===`${i}`||/^\/\:.+/.test(t.path));if(!c)return void console.error("route error: wrong route instantiation in generalDistributeRoutes:",i);if(n.push(c),c.redirectTo&&/^\/.*/.test(c.redirectTo)&&o+1===t.length){return n=findRoutes(buildPath(c.redirectTo),e,r)}}else{const c=n[o-1].children;c&&c instanceof Array||console.error("route error: routes not exit or routes must be an array!");const u=c.find(t=>t.path===`/${i}`||/^\/\:.+/.test(t.path));if(!u)return void console.error("route error: wrong route instantiation:",c);if(!u.component&&!u.redirectTo)return void console.error(`route error: path ${u.path} need a component which has children path or need a  redirectTo which has't children path`);if(n.push(u),u.redirectTo&&/^\/.*/.test(u.redirectTo)&&o+1===t.length){return n=findRoutes(buildPath(u.redirectTo),e,r)}}}return n}function findComponent(t,e){return t.map(t=>{const r=e.$components.find(e=>e.$selector===t.component);if(t.component&&r)return r.$components=e.$components,r})}var router={buildPath:buildPath,findRoutes:findRoutes,findComponent:findComponent};const buildPath$1=router.buildPath,findRoutes$1=router.findRoutes,findComponent$1=router.findComponent,window$4=new window$1,document$4=window$4.document;function renderToString(t,e,r){const n=r.$rootModule,o=r.$routeDOMKey,i=buildPath$1(t),c=findRoutes$1(i,e,n),u=findComponent$1(c,n),a=document$4.createElement("div");return u.forEach((t,e)=>{if(0===e){component(t,n,a,o)}else{const r=a.querySelectorAll(o)[e-1];component(t,n,r,o)}}),toString_1(a).replace(/^(\<div\>)/g,"").replace(/(\<\/div\>$)/g,"")}var src=renderToString;module.exports=src;
